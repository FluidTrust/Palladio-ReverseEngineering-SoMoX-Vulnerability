package org.palladiosimulator.pcm.confidentiality.reverseengineering.staticcodeanalysis.analyst;

import java.util.Collections;
import java.util.Set;

import org.palladiosimulator.somox.analyzer.rules.blackboard.RuleEngineBlackboard;
import org.palladiosimulator.somox.analyzer.rules.configuration.RuleEngineConfiguration;
import org.palladiosimulator.somox.analyzer.rules.service.Analyst;

import de.uka.ipd.sdq.workflow.jobs.IBlackboardInteractingJob;

public class SnykCodeAnalyst implements Analyst {
    public static final String ANALYST_ID = "org.palladiosimulator.pcm.confidentiality.reverseengineering.staticcodeanalysis.analyst";

    public static final String SNYK_EXE_LOCATION_KEY = "SNYK_EXE_LOCATION";
    public static final String DATABASE_API_KEY = "DATABASE_API_KEY";
    public static final String SNYK_TOKEN_KEY = "SNYK_TOKEN";

    private static final Set<String> CONFIGURATION_KEYS = Collections
        .unmodifiableSet(Set.of(SNYK_EXE_LOCATION_KEY, DATABASE_API_KEY, SNYK_TOKEN_KEY));

    @Override
    public IBlackboardInteractingJob<RuleEngineBlackboard> create(RuleEngineConfiguration configuration, RuleEngineBlackboard blackboard) {
        return new SnykCodeAnalystJob(configuration, blackboard);
    }

    @Override
    public Set<String> getConfigurationKeys() {
        return CONFIGURATION_KEYS;
    }

    @Override
    public String getName() {
        return "Snyk Code Analyst";
    }

    @Override
    public String getID() {
        return ANALYST_ID;
    }
}
